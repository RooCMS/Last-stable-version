(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],a)}else{a(CodeMirror)}}})(function(b){var c={};var g=/[^\s\u00a0]/;var e=b.Pos;function f(i){var h=i.search(g);return h==-1?0:h}b.commands.toggleComment=function(h){h.toggleComment()};b.defineExtension("toggleComment",function(k){if(!k){k=c}var h=this;var m=Infinity,j=this.listSelections(),n=null;for(var l=j.length-1;l>=0;l--){var p=j[l].from(),o=j[l].to();if(p.line>=m){continue}if(o.line>=m){o=e(m,0)}m=p.line;if(n==null){if(h.uncomment(p,o,k)){n="un"}else{h.lineComment(p,o,k);n="line"}}else{if(n=="un"){h.uncomment(p,o,k)}else{h.lineComment(p,o,k)}}}});function d(h,j,i){return/\bstring\b/.test(h.getTokenTypeAt(e(j.line,0)))&&!/^[\'\"`]/.test(i)}function a(h,j){var i=h.getMode();return i.useInnerComments===false||!i.innerMode?i:h.getModeAt(j)}b.defineExtension("lineComment",function(m,n,q){if(!q){q=c}var o=this,j=a(o,m);var l=o.getLine(m.line);if(l==null||d(o,m,l)){return}var p=q.lineComment||j.lineComment;if(!p){if(q.blockCommentStart||j.blockCommentStart){q.fullLines=true;o.blockComment(m,n,q)}return}var i=Math.min(n.ch!=0||n.line==m.line?n.line+1:n.line,o.lastLine()+1);var h=q.padding==null?" ":q.padding;var k=q.commentBlankLines||m.line==n.line;o.operation(function(){if(q.indent){var u=null;for(var t=m.line;t<i;++t){var r=o.getLine(t);var s=r.slice(0,f(r));if(u==null||u.length>s.length){u=s}}for(var t=m.line;t<i;++t){var r=o.getLine(t),v=u.length;if(!k&&!g.test(r)){continue}if(r.slice(0,v)!=u){v=f(r)}o.replaceRange(u+p+h,e(t,0),e(t,v))}}else{for(var t=m.line;t<i;++t){if(k||g.test(o.getLine(t))){o.replaceRange(p+h,e(t,0))}}}})});b.defineExtension("blockComment",function(l,m,p){if(!p){p=c}var o=this,j=a(o,l);var k=p.blockCommentStart||j.blockCommentStart;var n=p.blockCommentEnd||j.blockCommentEnd;if(!k||!n){if((p.lineComment||j.lineComment)&&p.fullLines!=false){o.lineComment(l,m,p)}return}if(/\bcomment\b/.test(o.getTokenTypeAt(e(l.line,0)))){return}var i=Math.min(m.line,o.lastLine());if(i!=l.line&&m.ch==0&&g.test(o.getLine(i))){--i}var h=p.padding==null?" ":p.padding;if(l.line>i){return}o.operation(function(){if(p.fullLines!=false){var s=g.test(o.getLine(i));o.replaceRange(h+n,e(i));o.replaceRange(k+h,e(l.line,0));var q=p.blockCommentLead||j.blockCommentLead;if(q!=null){for(var r=l.line+1;r<=i;++r){if(r!=i||s){o.replaceRange(q+h,e(r,0))}}}}else{o.replaceRange(n,m);o.replaceRange(k,l)}})});b.defineExtension("uncomment",function(B,l,m){if(!m){m=c}var y=this,v=a(y,B);var n=Math.min(l.ch!=0||l.line==B.line?l.line:l.line-1,y.lastLine()),o=Math.min(B.line,n);var x=m.lineComment||v.lineComment,k=[];var E=m.padding==null?" ":m.padding,q;lineComment:{if(!x){break lineComment}for(var C=o;C<=n;++C){var r=y.getLine(C);var s=r.indexOf(x);if(s>-1&&!/comment/.test(y.getTokenTypeAt(e(C,s+1)))){s=-1}if(s==-1&&g.test(r)){break lineComment}if(s>-1&&g.test(r.slice(0,s))){break lineComment}k.push(r)}y.operation(function(){for(var I=o;I<=n;++I){var G=k[I-o];var J=G.indexOf(x),H=J+x.length;if(J<0){continue}if(G.slice(H,H+E.length)==E){H+=E.length}q=true;y.replaceRange("",e(I,J),e(I,H))}});if(q){return true}}var t=m.blockCommentStart||v.blockCommentStart;var h=m.blockCommentEnd||v.blockCommentEnd;if(!t||!h){return false}var D=m.blockCommentLead||v.blockCommentLead;var A=y.getLine(o),u=A.indexOf(t);if(u==-1){return false}var p=n==o?A:y.getLine(n);var w=p.indexOf(h,n==o?u+t.length:0);if(w==-1&&o!=n){p=y.getLine(--n);w=p.indexOf(h)}if(w==-1||!/comment/.test(y.getTokenTypeAt(e(o,u+1)))||!/comment/.test(y.getTokenTypeAt(e(n,w+1)))){return false}var z=A.lastIndexOf(t,B.ch);var F=z==-1?-1:A.slice(0,B.ch).indexOf(h,z+t.length);if(z!=-1&&F!=-1&&F+h.length!=B.ch){return false}F=p.indexOf(h,l.ch);var j=p.slice(l.ch).lastIndexOf(t,F-l.ch);z=(F==-1||j==-1)?-1:l.ch+j;if(F!=-1&&z!=-1&&z!=l.ch){return false}y.operation(function(){y.replaceRange("",e(n,w-(E&&p.slice(w-E.length,w)==E?E.length:0)),e(n,w+h.length));var J=u+t.length;if(E&&A.slice(J,J+E.length)==E){J+=E.length}y.replaceRange("",e(o,u),e(o,J));if(D){for(var I=o+1;I<=n;++I){var H=y.getLine(I),K=H.indexOf(D);if(K==-1||g.test(H.slice(0,K))){continue}var G=K+D.length;if(E&&H.slice(G,G+E.length)==E){G+=E.length}y.replaceRange("",e(I,K),e(I,G))}}});return true})});